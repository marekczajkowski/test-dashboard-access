---
defaultRegistry: "ghcr.io/streamx-dev/streamx-blueprints"
defaultImageTag: "1.0.6-jvm"
ingestion:
  rest-ingestion:
    environment:
      QUARKUS_HTTP_AUTH_PERMISSION_BEARER_POLICY: "permit"
sources:
  cli:
    outgoing:
    - "pages"
    - "fragments"
    - "assets"
    - "web-resources"
    - "renderers"
    - "rendering-contexts"
    - "layouts"
    - "compositions"
  aem:
    outgoing:
    - "pages"
processing:
  blueprint-relay-web-resources:
    image: "relay-processing-service"
    incoming:
      messages:
        topic: "inboxes/web-resources"
    outgoing:
      relayed-messages:
        topic: "outboxes/web-resources"
    environment:
      MP_MESSAGING_INCOMING_MESSAGES_SCHEMA: "web-resource-schema"
      MP_MESSAGING_OUTGOING_RELAYED-MESSAGES_SCHEMA: "web-resource-schema"
  blueprint-relay-assets:
    image: "relay-processing-service"
    incoming:
      messages:
        topic: "inboxes/assets"
    outgoing:
      relayed-messages:
        topic: "outboxes/assets"
    environment:
      MP_MESSAGING_INCOMING_MESSAGES_SCHEMA: "asset-schema"
      MP_MESSAGING_OUTGOING_RELAYED-MESSAGES_SCHEMA: "asset-schema"
  blueprint-relay-fragments:
    image: "relay-processing-service"
    incoming:
      messages:
        topic: "inboxes/fragments"
    outgoing:
      relayed-messages:
        topic: "outboxes/fragments"
    environment:
      MP_MESSAGING_INCOMING_MESSAGES_SCHEMA: "fragment-schema"
      MP_MESSAGING_OUTGOING_RELAYED-MESSAGES_SCHEMA: "fragment-schema"
  blueprint-sitemap-generator:
    image: "sitemap-generator-processing-service"
    incoming:
      incoming-pages:
        topic: "inboxes/pages"
    outgoing:
      outgoing-sitemaps:
        topic: "outboxes/web-resources"
    environment:
      STREAMX_BLUEPRINTS_SITEMAP_GENERATOR_PROCESSING_SERVICE_BASE_URL: "http://localhost:8081"
      STREAMX_BLUEPRINTS_SITEMAP_GENERATOR_PROCESSING_SERVICE_OUTPUT_KEY: "sitemap.xml"
  relay-processing-service:
    image: "relay-processing-service"
    incoming:
      messages:
        topic: "inboxes/pages"
    outgoing:
      relayed-messages:
        topic: "outboxes/pages"
    environment:
      MP_MESSAGING_INCOMING_MESSAGES_SCHEMA: "page-schema"
      MP_MESSAGING_OUTGOING_RELAYED-MESSAGES_SCHEMA: "page-schema"
delivery:
  blueprint-web:
    image: "web-delivery-service"
    incoming:
      pages:
        topic: "outboxes/pages"
      fragments:
        topic: "outboxes/fragments"
      assets:
        topic: "outboxes/assets"
      web-resources:
        topic: "outboxes/web-resources"
    port: 8081
